//Author: Zeyad Azima
//Linkedin: https://www.linkedin.com/in/zer0verflow/
//Github: https://github.com/Zeyad-Azima
package cve_2022_1388;

import org.json.JSONException;

import java.io.IOException;
import java.lang.ArrayIndexOutOfBoundsException;
import java.util.Scanner;
public class exploit {

    public static void single(String target) throws Exception {

        singleCheck sc = new singleCheck(target);
        sc.testTarget();
        sc.vulnCheck();

    }

    public static void massvie(String filePath) throws Exception {

        massiveCheck mcheck = new massiveCheck(filePath);
        mcheck.readFile();

    }

    public static void eXploit(String target) throws JSONException, IOException {

        getShell shell = new getShell(target);
        shell.pwnShell();


    }


    public static void checkInput(String type) throws Exception {


        if (type.equals("scheck")) {
            Scanner scanner = new Scanner(System.in);
            System.out.println("Enter target URL:");
            String target = scanner.nextLine();
            System.out.println("[+] Start scan on " + target);
            single(target);


        } else if (type.equals("mcheck")) {
            Scanner scanner = new Scanner(System.in);
            System.out.println("Enter file path:");
            String target = scanner.nextLine();
            System.out.println("[+] Start scan on massive targets");
            massvie(target);


        } else if (type.equals("exploit")) {
            Scanner scanner = new Scanner(System.in);
            System.out.println("Enter target URL:");
            String target = scanner.nextLine();
            System.out.println("[+] Start exploiting " + target);
            eXploit(target);



        } else if(type.equals("help")){
            System.out.println("Scan a single target: java -jar cve-2022-1388.jar scheck");
            System.out.println("Scan targets from a file: java -jar cve-2022-1388.jar mcheck");
            System.out.println("Exploit a target: java -jar cve-2022-1388.jar exploit");
            System.exit(0);

        }else {
            System.out.println("[!] Invalid option");
            System.out.println("Use help option for information e.x: java -jar cve-2022-1388.jar help");
        }


    }



    public static void main(String[] args) throws Exception {
        System.out.println("@Author: Zeyad Azima");
        System.out.println("@Linkedin: https://www.linkedin.com/in/zer0verflow/");
        System.out.println("@Github: https://github.com/Zeyad-Azima");
        System.out.println("");
        try {
            String option = args[0];
            checkInput(option);
        } catch (ArrayIndexOutOfBoundsException e){
            System.out.println("[!] No arguments passed");
            System.out.println("Use help option for information e.x: cve-2022-1388.jar help");
        }
    }

}
